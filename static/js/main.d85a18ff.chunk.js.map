{"version":3,"sources":["Item/utils.ts","Item/ItemComponent.tsx","Item/Item.ts","Item/NewItemForm.tsx","Position/utils.ts","Position/Position.ts","Draggable/Draggable.tsx","Draggable/Undraggable.tsx","Group/GroupComponent.tsx","Group/utils.ts","App.tsx","index.tsx"],"names":["isLink","str","isUrl","getStyleObject","position","left","x","top","y","ItemComponent","title","onClick","otherProps","useState","deleted","setDeleted","setTimeout","className","classnames","href","rel","target","e","stopPropagation","replace","Item","timeStamp","Date","now","items","id","this","NewItemFrom","isGrouped","onCreate","onClose","newItemTitle","setNewItemTitle","style","onSubmit","event","preventDefault","length","item","group","type","autoFocus","value","onChange","onKeyDown","keyCode","getOffset","el","rect","getBoundingClientRect","window","scrollX","scrollY","Position","Draggable","ref","createRef","state","dragPosition","undefined","dragStartOffset","isValidDragTarget","closest","handleItemDragStart","pointerPosition","pageX","pageY","elementPosition","currentTarget","document","addEventListener","handleItemDrag","newPosition","setState","handleItemDragEnd","removeEventListener","props","onDragEnd","p","onMouseDown","onMouseUp","getStyle","children","Component","Undraggable","rest","GroupComponent","onRemove","shouldShowItemFormByDefault","showNewItemForm","setShowNewItemForm","toggleNewItemForm","cloneItem","params","transform","list","tag","setList","reorderedItems","editedGroup","map","filter","i","handleItemRemove","NewItemForm","text","textarea","createElement","body","appendChild","select","execCommand","removeChild","copyToClipboard","itemTitles","join","getCopiedText","React","memo","env","process","App","db","userId","history","setHistory","setItems","newItemPosition","setNewItemPosition","isObfuscated","setIsObfuscated","setItemsAndSave","newItems","saveHistory","collection","doc","set","JSON","parse","stringify","handleItemChange","newValue","oldValue","filteredItems","handleUndo","newHistory","pop","mapGroup","newPos","useEffect","metaKey","ctrlKey","get","then","currentDoc","exists","data","groupElements","obfuscated","visible","role","aria-label","require","firebase","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","firestore","user","a","provider","auth","GoogleAuthProvider","setPersistence","Auth","Persistence","LOCAL","signInWithPopup","ReactDOM","render","uid","getElementById","onAuthStateChanged","init"],"mappings":"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","file":"static/js/main.d85a18ff.chunk.js","sourcesContent":["import isUrl from \"is-url\";\nimport Position from \"../Position\";\n\nexport function isLink(str: string) {\n  return isUrl(str);\n}\n\nexport function getStyleObject(position?: Position) {\n  if (!position) return {};\n\n  return { left: position.x, top: position.y };\n}\n","import React, { useState } from \"react\";\nimport { isLink } from \"./utils\";\nimport classnames from \"classnames\";\n\ninterface Props {\n  title: string;\n  onClick: () => void;\n}\n\nconst ItemComponent: React.FC<Props> = ({ title, onClick, ...otherProps }) => {\n  const [deleted, setDeleted] = useState(false);\n\n  function handleClick() {\n    setDeleted(true);\n\n    setTimeout(() => {\n      onClick();\n    }, 200);\n  }\n\n  function parseTitle() {\n    let urlSliceRegex = /(https?:\\/\\/)?(www\\.)?/;\n    if (isLink(title)) {\n      return title.replace(urlSliceRegex, \"\");\n    }\n    return title;\n  }\n\n  return (\n    <li\n      {...otherProps}\n      onClick={handleClick}\n      className={classnames(\"item \", {\n        \"item--collapse\": deleted,\n      })}\n    >\n      <span className=\"item-content item-content-block\" title={title}>\n        {isLink(title) ? (\n          <a\n            href={title}\n            rel=\"noreferrer noopener\"\n            target=\"_blank\"\n            onClick={(e) => {\n              e.stopPropagation();\n            }}\n          >\n            {parseTitle()}\n          </a>\n        ) : (\n          title\n        )}\n      </span>\n    </li>\n  );\n};\n\nexport default ItemComponent;\n","import Position from \"../Position\";\n\ninterface ConstructorProps {\n  title: string;\n  position?: Position;\n  timeStamp?: number;\n  items?: Item[]\n}\n\nexport default class Item {\n  id: number;\n  title: string;\n  position?: Position;\n  timeStamp: number;\n  items: Item[]\n\n  constructor({\n    title = \"\",\n    position,\n    timeStamp = Date.now(),\n    items = [],\n  }: ConstructorProps) {\n    this.id = timeStamp;\n    this.title = title;\n    this.position = position;\n    this.timeStamp = timeStamp;\n    this.items = items;\n  }\n}\n","import React, { ChangeEvent, FormEvent, KeyboardEvent, useState } from \"react\";\nimport Item from \"./Item\";\nimport { getStyleObject } from \"./utils\";\nimport classnames from \"classnames\";\nimport Position from \"../Position\";\n\ninterface Props {\n  isGrouped?: boolean;\n  position?: Position;\n  onCreate: (item: Item) => void;\n  onClose: () => void;\n}\n\nconst NewItemFrom: React.FC<Props> = ({ isGrouped = false, position, onCreate, onClose }) => {\n  const [newItemTitle, setNewItemTitle] = useState(\"\");\n\n  function handleCreateItem(event: FormEvent) {\n    event.preventDefault();\n\n    if (!newItemTitle.length) return;\n\n    const item = new Item({ position, title: newItemTitle });\n    onCreate(item);\n    setNewItemTitle(\"\");\n  }\n\n  function handleInputKeyDown(event: KeyboardEvent<HTMLInputElement>) {\n    switch (event.keyCode) {\n      case 27: // esc\n        return onClose();\n      case 8: // backspace\n        if (newItemTitle.length) return;\n        return onClose();\n      default:\n        return;\n    }\n  }\n\n  function handleTitleChange({ target: { value } }: ChangeEvent<HTMLInputElement>) {\n    setNewItemTitle(value);\n  }\n\n  function handleCreateGroup() {\n    const group = new Item({\n      position: position,\n      title: newItemTitle,\n      items: [],\n    });\n    onCreate(group);\n  }\n\n  return (\n    <form\n      className={classnames(\"new-item item\", { \"item--absolute\": position })}\n      style={getStyleObject(position)}\n      onSubmit={isGrouped ? handleCreateItem : handleCreateGroup}\n    >\n      <input\n        type=\"text\"\n        className=\"item-content\"\n        autoFocus={true}\n        value={newItemTitle}\n        onChange={handleTitleChange}\n        onKeyDown={handleInputKeyDown}\n      />\n    </form>\n  );\n};\n\nexport default NewItemFrom;\n","export function getOffset(el: Element) {\n  const rect = el.getBoundingClientRect();\n  return {\n    x: rect.left + window.scrollX,\n    y: rect.top + window.scrollY,\n  };\n}\n","export default class Position {\n  x: number;\n  y: number;\n\n  constructor({ x = 0, y = 0 } = {}) {\n    this.x = x;\n    this.y = y;\n  }\n}\n","import { Component, createRef, MouseEventHandler } from \"react\";\nimport Position, { getOffset } from \"../Position\";\n\ninterface Props {\n  onDragEnd: (pos: Position) => void;\n  position?: Position;\n}\n\nclass Draggable extends Component<Props> {\n  ref = createRef<HTMLDivElement>();\n\n  state: {\n    dragPosition?: Position\n  } = {\n    dragPosition: undefined\n  };\n\n  dragStartOffset = {\n    x: 0,\n    y: 0\n  }\n\n  isValidDragTarget = (target: any) => {\n    const isChildOfGroupItems = !!target.closest(\".undraggable\");\n    return !isChildOfGroupItems;\n  };\n\n  handleItemDragStart: MouseEventHandler = (event) => {\n    if (!this.isValidDragTarget(event.target)) return;\n\n    const pointerPosition = { x: event.pageX, y: event.pageY };\n    const elementPosition = getOffset(event.currentTarget);\n    this.dragStartOffset = {\n      x: pointerPosition.x - elementPosition.x,\n      y: pointerPosition.y - elementPosition.y,\n    };\n\n    document.addEventListener(\"mousemove\", this.handleItemDrag);\n  };\n\n  handleItemDrag = (event: MouseEvent) => {\n    const newPosition = new Position({\n      x: event.pageX - this.dragStartOffset.x,\n      y: event.pageY - this.dragStartOffset.y,\n    });\n\n    this.setState({\n      dragPosition: newPosition,\n    });\n  };\n\n  handleItemDragEnd = () => {\n    document.removeEventListener(\"mousemove\", this.handleItemDrag);\n\n    if (this.state.dragPosition) {\n      this.props.onDragEnd({ ...this.state.dragPosition });\n      this.setState({ dragPosition: null });\n    }\n  };\n\n  getStyle(p?: Position) {\n    return {\n      left: p?.x,\n      top: p?.y,\n    };\n  }\n\n  render() {\n    return (\n      <div\n        className=\"draggable item--absolute\"\n        ref={this.ref}\n        onMouseDown={this.handleItemDragStart}\n        onMouseUp={this.handleItemDragEnd}\n        style={this.getStyle(this.state.dragPosition || this.props.position)}\n      >\n        {this.props.children}\n      </div>\n    );\n  }\n}\n\nexport default Draggable;\n","import React, { MouseEvent } from \"react\";\nimport classnames from \"classnames\";\n\ninterface Props {\n  className?: string;\n  onClick?:(e: MouseEvent<HTMLDivElement>) => void;\n}\n\nconst Undraggable: React.FC<Props> = ({ children, className = \"\", ...rest }) => (\n  <div className={classnames(\"undraggable\", className)} {...rest}>\n    {children}\n  </div>\n);\n\nexport default Undraggable;\n","import React, { useState } from \"react\";\nimport Item from \"../Item\";\nimport { ItemComponent, NewItemForm } from \"../Item\";\nimport { ReactSortable as Sortable } from \"react-sortablejs\";\nimport classnames from \"classnames\";\nimport { Undraggable } from \"../Draggable\";\nimport { getCopiedText, copyToClipboard } from \"./utils\";\nimport Position from \"../Position\";\n\ninterface Props {\n  position?: Position;\n  title: string;\n  items: Item[];\n  timeStamp?: number;\n  onChange: (item: Item) => void;\n  onRemove: () => void;\n}\n\nconst GroupComponent: React.FC<Props> = ({\n  position,\n  title,\n  items,\n  timeStamp,\n  onChange,\n  onRemove,\n}) => {\n  const shouldShowItemFormByDefault = !items.length;\n  const [showNewItemForm, setShowNewItemForm] = useState(\n    shouldShowItemFormByDefault\n  );\n\n  const [deleted, setDeleted] = useState(false);\n\n  function handleGroupDelete() {\n    setDeleted(true);\n\n    setTimeout(() => {\n      onRemove();\n    }, 200);\n  }\n\n  function toggleNewItemForm() {\n    setShowNewItemForm(!showNewItemForm);\n  }\n\n  function handleItemCreate(item: Item) {\n    const editedGroup = cloneItem({ items: [...items, item] });\n    onChange(editedGroup);\n  }\n\n  function handleItemRemove(item: Item) {\n    const filteredItems = items.filter((i) => i.timeStamp !== item.timeStamp);\n\n    const editedGroup = cloneItem({ items: filteredItems });\n    onChange(editedGroup);\n    setShowNewItemForm(false);\n  }\n\n  function handleItemOrderChange(reorderedItems: Item[]) {\n    const editedGroup = cloneItem({ items: reorderedItems });\n    onChange(editedGroup);\n  }\n\n  function handleCopy() {\n    copyToClipboard(getCopiedText({ title, items }));\n  }\n\n  function mapItem(item: Item) {\n    return (\n      <ItemComponent\n        key={item.timeStamp}\n        title={item.title}\n        onClick={() => handleItemRemove(item)}\n      />\n    );\n  }\n\n  function cloneItem(params = {}) {\n    return new Item({\n      position,\n      title,\n      items,\n      timeStamp,\n      ...params,\n    });\n  }\n\n  function getStyle() {\n    return {\n      transform: deleted ? \"scale(0.7)\" : \"\",\n    };\n  }\n\n  return (\n    <div\n      className={classnames(\"item group\", {\n        \"item--collapse\": deleted,\n      })}\n      style={getStyle()}\n    >\n      {title && <span className=\"item-content\">{title}</span>}\n      <Undraggable className=\"item-add item-button\" onClick={toggleNewItemForm}>\n        +\n      </Undraggable>\n\n      <Undraggable\n        className=\"item-remove item-button\"\n        onClick={handleGroupDelete}\n      >\n        &times;\n      </Undraggable>\n\n      {(items.length || showNewItemForm) && (\n        <div className=\"group-items\">\n          <Undraggable>\n            <Sortable list={items} tag=\"ul\" setList={handleItemOrderChange}>\n              {items.map(mapItem)}\n            </Sortable>\n\n            {showNewItemForm && (\n              <NewItemForm\n                isGrouped\n                onCreate={handleItemCreate}\n                onClose={toggleNewItemForm}\n              />\n            )}\n          </Undraggable>\n        </div>\n      )}\n      {!!items.length && (\n        <Undraggable onClick={handleCopy} className=\"item-copy\">\n          <button>copy</button>\n        </Undraggable>\n      )}\n    </div>\n  );\n};\n\n\nexport default React.memo(GroupComponent);\n","import Item from \"../Item\";\n\nexport function getCopiedText({ title, items = [] }: {title: string, items?: Item[] }) {\n  const itemTitles = items.map(({ title }) => `- ${title}`);\n\n  return [title, ...itemTitles].join(\"\\n\");\n}\n\nexport function copyToClipboard(text: string) {\n  const textarea = document.createElement(\"textarea\");\n  // @ts-ignore\n  textarea.style = {\n    position: \"absolute\",\n    top: \"-1000px\",\n  };\n  textarea.value = text;\n  document.body.appendChild(textarea);\n  textarea.select();\n  document.execCommand(\"copy\");\n  document.body.removeChild(textarea);\n}\n","import React, { useState, useEffect, MouseEvent } from \"react\";\nimport classnames from \"classnames\";\nimport \"./App.scss\";\n\nimport Item, { NewItemForm } from \"./Item\";\nimport Position from \"./Position\";\nimport { GroupComponent } from \"./Group\";\nimport { Draggable } from \"./Draggable\";\nimport firebase from \"firebase\";\n\ninterface Props {\n  db: firebase.firestore.Firestore;\n  userId: string;\n}\n\nconst env = process.env.NODE_ENV;\nconst PERSIST_IN_DEV = false;\nconst PERSIST = env === 'production' || PERSIST_IN_DEV;\n\nconst App: React.FC<Props> = ({ db, userId }) => {\n  const [history, setHistory] = useState<Item[][]>([]);\n  const [items, setItems] = useState<Item[]>([]);\n  const [newItemPosition, setNewItemPosition] = useState<Position>();\n  const [isObfuscated, setIsObfuscated] = useState<boolean>(false);\n\n  useEffect(() => {\n    document.addEventListener(\"keydown\", (e) => {\n      if (e.keyCode === 90 && (e.metaKey || e.ctrlKey)) {\n        e.preventDefault();\n        handleUndo();\n      }\n    });\n  });\n\n  useEffect(() => {\n    db.collection(\"items\")\n      .doc(userId)\n      .get()\n      .then((currentDoc) => {\n        if (currentDoc.exists) {\n          setItems(currentDoc.data()?.items);\n        }\n      });\n  }, [db, userId]);\n\n  function toggleAddItem(event: MouseEvent<HTMLDivElement>) {\n    if (event.target !== event.currentTarget) return;\n\n    const position = new Position({ x: event.pageX, y: event.pageY });\n    setNewItemPosition(position);\n  }\n\n  function setItemsAndSave(newItems: Item[], saveHistory = true) {\n    if (saveHistory) {\n      setHistory([...history, items]);\n    }\n    setItems(newItems);\n    if (PERSIST) {\n      db.collection(\"items\")\n        .doc(userId)\n        .set({ items: JSON.parse(JSON.stringify(newItems)) });\n    }\n  }\n\n  function handleItemCreate(item: Item) {\n    setItemsAndSave([...items, item]);\n    setNewItemPosition(undefined);\n  }\n\n  function handleItemChange(newValue: Item, oldValue: Item) {\n    const filteredItems = items.filter(\n      (i) => i.timeStamp !== oldValue.timeStamp\n    );\n\n    setItemsAndSave([...filteredItems, newValue]);\n    setNewItemPosition(undefined);\n  }\n\n  function handleItemRemove(item: Item) {\n    const filteredItems = items.filter((i) => i.timeStamp !== item.timeStamp);\n    setItemsAndSave([...filteredItems]);\n  }\n\n  function handleUndo() {\n    if (!history.length) return;\n\n    setItemsAndSave(history[history.length - 1] || [], false);\n\n    const newHistory = [...history];\n    newHistory.pop();\n    setHistory(newHistory);\n  }\n\n  function handleObfuscate() {\n    setIsObfuscated(!isObfuscated);\n  }\n\n  function mapGroup(group: Item) {\n    return (\n      <Draggable\n        position={group.position}\n        onDragEnd={(newPos) =>\n          handleItemChange({ ...group, position: newPos }, group)\n        }\n        key={group.timeStamp}\n      >\n        <GroupComponent\n          {...group}\n          onRemove={() => handleItemRemove(group)}\n          onChange={(newValue) => handleItemChange(newValue, group)}\n        />\n      </Draggable>\n    );\n  }\n\n  const groupElements = items.map((group) => {\n    return mapGroup(group);\n  });\n\n\n  return (\n    <div className=\"app\">\n      <div\n        className={classnames(\"board\", { obfuscated: isObfuscated }, env)}\n        onClick={toggleAddItem}\n      >\n        <ul>{groupElements}</ul>\n        {newItemPosition && (\n          <NewItemForm\n            onCreate={handleItemCreate}\n            position={newItemPosition}\n            onClose={() => setNewItemPosition(undefined)}\n          />\n        )}\n        <button\n          className={classnames(\"undo action\", { visible: history.length })}\n          onClick={handleUndo}\n        >\n          <span role=\"img\" aria-label=\"Undo\">\n            🤭\n          </span>\n        </button>\n\n        <button\n          className={classnames(\"obfuscate action \", { visible: items.length })}\n          onClick={handleObfuscate}\n        >\n          <span role=\"img\" aria-label=\"Obfuscate\">\n            {isObfuscated ? \"🐵\" : \"🙈\"}\n          </span>\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport firebase from \"firebase\";\n\nrequire(\"firebase/firestore\");\n\nconst firebaseConfig = {\n  apiKey: \"AIzaSyC5Er4oZT-e4woRNxf9ZG59c4-MnP9ussQ\",\n  authDomain: \"dragly-359ad.firebaseapp.com\",\n  projectId: \"dragly-359ad\",\n  storageBucket: \"\",\n  messagingSenderId: \"747702472609\",\n  appId: \"1:747702472609:web:3f48f2bbe7117d8c87c5e0\",\n};\nfirebase.initializeApp(firebaseConfig);\nconst db = firebase.firestore();\n\nasync function init(user: firebase.User | null) {\n  if (!user) {\n    // Start a sign in process for an unauthenticated user.\n    const provider = new firebase.auth.GoogleAuthProvider();\n    await firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL);\n    await firebase.auth().signInWithPopup(provider);\n  }\n  if (user) {\n    ReactDOM.render(\n      <App db={db} userId={user.uid} />,\n      document.getElementById(\"root\")\n    );\n  }\n}\n\nfirebase.auth().onAuthStateChanged((user) => {\n  init(user);\n});\n"],"sourceRoot":""}