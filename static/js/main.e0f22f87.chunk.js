(this["webpackJsonpto-drag-list"]=this["webpackJsonpto-drag-list"]||[]).push([[0],{37:function(t,e,n){},38:function(t,e,n){},47:function(t,e,n){"use strict";n.r(e);var i=n(13),a=n.n(i),c=n(17),r=n(6),o=n.n(r),s=n(26),u=n.n(s),l=(n(37),n(12)),d=n(20),j=n(9),b=n(11),m=n(10),f=n.n(m),p=(n(38),n(21)),h=n(27),v=n.n(h);function O(t){return v()(t)}function g(t){return t?{left:t.x,top:t.y}:{}}var x=n(3),y=["title","onClick"],S=function(t){var e=t.title,n=t.onClick,i=Object(p.a)(t,y),a=Object(r.useState)(!1),c=Object(b.a)(a,2),o=c[0],s=c[1];return Object(x.jsx)("li",Object(j.a)(Object(j.a)({},i),{},{onClick:function(){s(!0),setTimeout((function(){n()}),200)},className:f()("item ",{"item--collapse":o}),children:Object(x.jsx)("span",{className:"item-content item-content-block",title:e,children:O(e)?Object(x.jsx)("a",{href:e,rel:"noreferrer noopener",target:"_blank",onClick:function(t){t.stopPropagation()},children:O(e)?e.replace(/(https?:\/\/)?(www\.)?/,""):e}):e})}))},w=n(16),C=function t(e){var n=e.title,i=void 0===n?"":n,a=e.position,c=e.timeStamp,r=void 0===c?Date.now():c,o=e.items,s=void 0===o?[]:o;Object(w.a)(this,t),this.id=void 0,this.title=void 0,this.position=void 0,this.timeStamp=void 0,this.items=void 0,this.id=r,this.title=i,this.position=a,this.timeStamp=r,this.items=s},k=function(t){var e=t.isGrouped,n=void 0!==e&&e,i=t.position,a=t.onCreate,c=t.onClose,o=Object(r.useState)(""),s=Object(b.a)(o,2),u=s[0],l=s[1];return Object(x.jsx)("form",{className:f()("new-item item",{"item--absolute":i,group:!n}),style:g(i),onSubmit:n?function(t){if(t.preventDefault(),u.length){var e=new C({position:i,title:u});a(e),l("")}}:function(){var t=new C({position:i,title:u,items:[]});a(t)},children:Object(x.jsx)("input",{type:"text",className:"item-content",autoFocus:!0,value:u,onChange:function(t){var e=t.target.value;l(e)},onKeyDown:function(t){switch(t.keyCode){case 27:return c();case 8:if(u.length)return;return c();default:return}}})})};function N(t){var e=t.getBoundingClientRect();return{x:e.left+window.scrollX,y:e.top+window.scrollY}}var D=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.x,i=void 0===n?0:n,a=e.y,c=void 0===a?0:a;Object(w.a)(this,t),this.x=void 0,this.y=void 0,this.x=i,this.y=c},E=n(28),I=n(29),P=n(31),A=n(30),L=function(t){Object(P.a)(n,t);var e=Object(A.a)(n);function n(){var t;Object(w.a)(this,n);for(var i=arguments.length,a=new Array(i),c=0;c<i;c++)a[c]=arguments[c];return(t=e.call.apply(e,[this].concat(a))).ref=Object(r.createRef)(),t.state={dragPosition:void 0},t.dragStartOffset={x:0,y:0},t.isValidDragTarget=function(t){return!!!t.closest(".undraggable")},t.handleItemDragStart=function(e){if(t.isValidDragTarget(e.target)){var n=e.pageX,i=e.pageY,a=N(e.currentTarget);t.dragStartOffset={x:n-a.x,y:i-a.y},document.addEventListener("mousemove",t.handleItemDrag)}},t.handleItemDrag=function(e){var n=new D({x:e.pageX-t.dragStartOffset.x,y:e.pageY-t.dragStartOffset.y});t.setState({dragPosition:n})},t.handleItemDragEnd=function(){document.removeEventListener("mousemove",t.handleItemDrag),t.state.dragPosition&&(t.props.onDragEnd(Object(j.a)({},t.state.dragPosition)),t.setState({dragPosition:null}))},t}return Object(I.a)(n,[{key:"getStyle",value:function(t){return{left:null===t||void 0===t?void 0:t.x,top:null===t||void 0===t?void 0:t.y}}},{key:"render",value:function(){return Object(x.jsx)("div",{className:"draggable item--absolute",ref:this.ref,onMouseDown:this.handleItemDragStart,onMouseUp:this.handleItemDragEnd,style:this.getStyle(this.state.dragPosition||this.props.position),children:this.props.children})}}]),n}(r.Component),T=["children","className"],R=function(t){var e=t.children,n=t.className,i=void 0===n?"":n,a=Object(p.a)(t,T);return Object(x.jsx)("div",Object(j.a)(Object(j.a)({className:f()("undraggable",i)},a),{},{children:e}))};var G=function(t){var e=t.position,n=t.title,i=t.items,a=t.timeStamp,c=t.onChange,o=t.onRemove,s=!i.length,u=Object(r.useState)(s),d=Object(b.a)(u,2),m=d[0],p=d[1],h=Object(r.useState)(!1),v=Object(b.a)(h,2),O=v[0],g=v[1];function y(){p(!m)}function w(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new C(Object(j.a)({position:e,title:n,items:i,timeStamp:a},t))}return Object(x.jsxs)("div",{className:f()("item group",{"item--collapse":O}),style:{transform:O?"scale(0.7)":""},children:[Object(x.jsxs)("div",{className:"group-header",children:[Object(x.jsxs)("div",{className:"group-header-left",children:[n&&Object(x.jsx)("span",{className:"item-content",children:n}),Object(x.jsx)(R,{className:"item-add item-button",onClick:y,children:"+"})]}),Object(x.jsx)(R,{className:"item-remove item-button",onClick:function(){g(!0),setTimeout((function(){o()}),200)},children:"\xd7"})]}),(i.length||m)&&Object(x.jsx)("div",{className:"group-items",children:Object(x.jsxs)(R,{children:[Object(x.jsx)(E.ReactSortable,{list:i,tag:"ul",setList:function(t){var e=w({items:t});c(e)},children:i.map((function(t){return Object(x.jsx)(S,{title:t.title,onClick:function(){return function(t){var e=w({items:i.filter((function(e){return e.timeStamp!==t.timeStamp}))});c(e),p(!1)}(t)}},t.timeStamp)}))}),m&&Object(x.jsx)(k,{isGrouped:!0,onCreate:function(t){var e=w({items:[].concat(Object(l.a)(i),[t])});c(e)},onClose:y})]})}),!!i.length&&Object(x.jsx)(R,{onClick:function(){!function(t){var e=document.createElement("textarea");e.style={position:"absolute",top:"-1000px"},e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}(function(t){var e=t.title,n=t.items,i=(void 0===n?[]:n).map((function(t){var e=t.title;return"- ".concat(e)}));return[e].concat(Object(l.a)(i)).join("\n")}({title:n,items:i}))},className:"item-copy",children:Object(x.jsx)("button",{children:"copy"})})]})},J=o.a.memo(G),K="production",X="items",Y="items",B=function(t){var e=t.db,n=t.userId,i=Object(r.useState)([]),o=Object(b.a)(i,2),s=o[0],u=o[1],m=Object(r.useState)(),p=Object(b.a)(m,2),h=p[0],v=p[1],O=Object(r.useState)(),g=Object(b.a)(O,2),y=g[0],S=g[1],w=Object(r.useState)(!1),C=Object(b.a)(w,2),N=C[0],E=C[1],I=Object(r.useState)(!1),P=Object(b.a)(I,2),A=P[0],T=P[1],R=Object(r.useState)(),G=Object(b.a)(R,2),B=G[0],M=G[1],z=(null===h||void 0===h?void 0:h.items)||[],U=function(t){v((function(e){return Object(j.a)(Object(j.a)({},e),{},Object(d.a)({},Y,t))}))};function V(t){return Z.apply(this,arguments)}function Z(){return(Z=Object(c.a)(a.a.mark((function t(e){var n=arguments;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(!(n.length>1&&void 0!==n[1])||n[1])&&u([].concat(Object(l.a)(s),[z])),U(e);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function F(t,e){var n=z.filter((function(t){return t.timeStamp!==e.timeStamp}));V([].concat(Object(l.a)(n),[t])),S(void 0)}function Q(){if(s.length){V(s[s.length-1]||[],!1);var t=Object(l.a)(s);t.pop(),u(t)}}function W(t){return Object(x.jsx)(L,{position:t.position,onDragEnd:function(e){return F(Object(j.a)(Object(j.a)({},t),{},{position:e}),t)},children:Object(x.jsx)(J,Object(j.a)(Object(j.a)({},t),{},{onRemove:function(){return function(t){var e=z.filter((function(e){return e.timeStamp!==t.timeStamp}));V(Object(l.a)(e))}(t)},onChange:function(e){return F(e,t)}}))},t.timeStamp)}Object(r.useEffect)((function(){document.addEventListener("keydown",(function(t){90===t.keyCode&&(t.metaKey||t.ctrlKey)&&(t.preventDefault(),Q())}))})),Object(r.useEffect)((function(){T(!0),M(void 0),e.collection(X).doc(n).get().then((function(t){t.exists?v(t.data()||{}):M(Error("Doc doesn't exist!")),T(!1)})).catch((function(t){M(t)}))}),[e,n]),Object(r.useEffect)((function(){(function(){var t=Object(c.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!h){t.next=12;break}return T(!0),M(void 0),t.prev=3,t.next=6,e.collection(X).doc(n).set((i=h,JSON.parse(JSON.stringify(i))));case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),M(t.t0);case 11:T(!1);case 12:case"end":return t.stop()}var i}),t,null,[[3,8]])})));return function(){return t.apply(this,arguments)}})()()}),[h,e,n]);var _=z.map((function(t){return W(t)}));return Object(x.jsx)("div",{className:"app",children:Object(x.jsxs)("div",{className:f()("board",{obfuscated:N},K),onClick:function(t){if(t.target===t.currentTarget){var e=new D({x:t.pageX,y:t.pageY});S(e)}},children:[Object(x.jsx)("ul",{children:_}),y&&Object(x.jsx)(k,{onCreate:function(t){V([].concat(Object(l.a)(z),[t])),S(void 0)},position:y,onClose:function(){return S(void 0)}}),Object(x.jsx)("button",{className:f()("undo action",{visible:s.length}),onClick:Q,children:Object(x.jsx)("span",{role:"img","aria-label":"Undo",children:"\ud83e\udd2d"})}),Object(x.jsx)("div",{className:f()("loading action",{visible:A}),children:Object(x.jsx)("span",{role:"img","aria-label":"Loading",children:"\u267b\ufe0f"})}),Object(x.jsx)("div",{className:f()("error action",{visible:!!B}),children:Object(x.jsx)("span",{role:"img","aria-label":"Error",children:"\u26d4"})}),Object(x.jsx)("button",{className:f()("obfuscate action ",{visible:z.length}),onClick:function(){E(!N)},children:Object(x.jsx)("span",{role:"img","aria-label":"Obfuscate",children:N?"\ud83d\udc35":"\ud83d\ude48"})}),!!B&&Object(x.jsxs)("div",{className:"error-modal",children:[Object(x.jsx)("h2",{children:B.name}),Object(x.jsx)("p",{children:B.message}),Object(x.jsx)("br",{}),B.stack&&Object(x.jsx)("pre",{children:B.stack})]})]})})},M=n(15);n(46);M.a.initializeApp({apiKey:"AIzaSyC5Er4oZT-e4woRNxf9ZG59c4-MnP9ussQ",authDomain:"dragly-359ad.firebaseapp.com",projectId:"dragly-359ad",storageBucket:"",messagingSenderId:"747702472609",appId:"1:747702472609:web:3f48f2bbe7117d8c87c5e0"});var z=M.a.firestore();function U(){return(U=Object(c.a)(a.a.mark((function t(e){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=6;break}return n=new M.a.auth.GoogleAuthProvider,t.next=4,M.a.auth().setPersistence(M.a.auth.Auth.Persistence.LOCAL);case 4:return t.next=6,M.a.auth().signInWithPopup(n);case 6:e&&u.a.render(Object(x.jsx)(B,{db:z,userId:e.uid}),document.getElementById("root"));case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}M.a.auth().onAuthStateChanged((function(t){!function(t){U.apply(this,arguments)}(t)}))}},[[47,1,2]]]);
//# sourceMappingURL=main.e0f22f87.chunk.js.map